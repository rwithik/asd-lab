% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\newenvironment{Shaded}{}{}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering

\date{}

\begin{document}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Create and populate shown tables. Check the following constraints:

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \tightlist
  \item
    Song\_ID should be of the format ``S00\_\_''
  \item
    Album\_ID should be of the format ``AL00\_\_'',
  \item
    Album\_ID should be of the format ``AL00\_\_'',
  \item
    Artist\_ID should be of the format ``AR00\_\_''.
  \end{enumerate}

  ```sql create table song( songid varchar(10) check(songid like
  'S00\_\_'), songname varchar(25), albumid varchar(10) check(albumid
  like 'AL00\_\_'), genre varchar(10), views integer);
\end{enumerate}

INSERT INTO song VALUES(`S0001', `Panic and Sentiment', `AL0004', `Pop',
450); INSERT INTO song VALUES(`S0002', `Addicted to Dignity', `AL0001',
`Rap', 600); INSERT INTO song VALUES(`S0003', `Expressed', `AL0002',
`Pop', 500); INSERT INTO song VALUES(`S0004', `Promise to Science',
`AL0005', `Rock', 920); INSERT INTO song VALUES(`S0005', `Comfortable
Illusion', `AL0003', `Rock', 760); INSERT INTO song VALUES(`S0006',
`Handicapped Bomber', `AL0002', `Rap', 1000); INSERT INTO song
VALUES(`S0007', `Default Agenda', `AL0004', `Jazz', 260); INSERT INTO
song VALUES(`S0008', `Tropical River', `AL0002', `Pop', 420);

create table album( albumid varchar(10) check(albumid like 'AL00\_\_'),
albumname varchar(25), artistid varchar(10) check(artistid like
'AR00\_\_'), releasedate date, sales integer);

INSERT INTO album VALUES(`AL0001', `Jurisdiction', `AR0004',
`16-03-2004', 570); INSERT INTO album VALUES(`AL0002', `Limitless',
`AR0003', `24-05-2007', 650); INSERT INTO album VALUES(`AL0003', `69
cents', `AR0001', `6-09-2005', 400); INSERT INTO album VALUES(`AL0004',
`Confession', `AR0002', `28-11-2012', 120); INSERT INTO album
VALUES(`AL0005', `Hero', `AR0004', `7-07-2002', 900);

create table artist( artistid varchar(10) check(artistid like
'AR00\_\_'), artistname varchar(25), country varchar(20));

INSERT INTO artist VALUES(`AR0001', `Natalia Finch', `France'); INSERT
INTO artist VALUES(`AR0002', `Suman Yu', `India'); INSERT INTO artist
VALUES(`AR0003', `Hill Will', `USA'); INSERT INTO artist
VALUES(`AR0004', `Sham E', `France');

create table grammy ( year integer, songid varchar(10));

INSERT INTO grammy VALUES(2003, `S0004'); INSERT INTO grammy
VALUES(2007, `S0006'); INSERT INTO grammy VALUES(2009, `S0003'); INSERT
INTO grammy VALUES(2004, `S0002'); INSERT INTO grammy VALUES(2012,
`S0007');

\begin{verbatim}
```
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\item
  List all the songs by Sham E in the year 2002.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{select}\NormalTok{ songname }\KeywordTok{from}\NormalTok{ song s, artist a, album b }\KeywordTok{where}\NormalTok{ a.artistname }\OperatorTok{=} \StringTok{\textquotesingle{}Sham E\textquotesingle{}} \KeywordTok{AND}\NormalTok{ a.artistid }\OperatorTok{=}\NormalTok{ b.artistid }\KeywordTok{and}\NormalTok{ s.albumid}\OperatorTok{=}\NormalTok{b.albumid }\KeywordTok{and}\NormalTok{ b.releasedate }\OperatorTok{<} \StringTok{\textquotesingle{}2003{-}01{-}01\textquotesingle{}} \KeywordTok{and}\NormalTok{ b.releasedate }\OperatorTok{>} \StringTok{\textquotesingle{}2001{-}12{-}31\textquotesingle{}}\NormalTok{;}
\end{Highlighting}
\end{Shaded}
\item
  List all songs in the same album as Expressed.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{select}\NormalTok{ songname }\KeywordTok{from}\NormalTok{ song s }\KeywordTok{where}\NormalTok{ s.albumid }\KeywordTok{in}\NormalTok{ (}\KeywordTok{select}\NormalTok{ albumid }\KeywordTok{from}\NormalTok{ song }\KeywordTok{where}\NormalTok{ songname }\OperatorTok{=} \StringTok{\textquotesingle{}Expressed\textquotesingle{}}\NormalTok{);}
\end{Highlighting}
\end{Shaded}
\item
  Display the name and total number of views of all albums with sales
  more than 500.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{select}\NormalTok{ albumname, }\FunctionTok{sum}\NormalTok{(views) }\KeywordTok{from}\NormalTok{ song, album }\KeywordTok{where}\NormalTok{ sales }\OperatorTok{>} \DecValTok{500} \KeywordTok{and}\NormalTok{ song.albumid}\OperatorTok{=}\NormalTok{album.albumid }\KeywordTok{group} \KeywordTok{by}\NormalTok{ albumname;}
\end{Highlighting}
\end{Shaded}
\item
  Display the number of songs that did not win a Grammy in each album.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{select}\NormalTok{ b.albumid, }\FunctionTok{count}\NormalTok{(}\OperatorTok{*}\NormalTok{) }\KeywordTok{from}\NormalTok{ album b, song s }\KeywordTok{where}\NormalTok{ s.albumid }\OperatorTok{=}\NormalTok{ b.albumid }\KeywordTok{and}\NormalTok{ songid }\KeywordTok{not} \KeywordTok{in}\NormalTok{ (}\KeywordTok{select}\NormalTok{ songid }\KeywordTok{from}\NormalTok{ grammy) }\KeywordTok{group} \KeywordTok{by}\NormalTok{ b.albumid;}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{5}
\tightlist
\item
  Create a Trigger such that whenever a new song is added, if it has
  more than 750 views, it wins a Grammy in that year itself.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{create} \KeywordTok{or} \KeywordTok{replace} \KeywordTok{function}\NormalTok{ check\_grammy()}
\NormalTok{returns }\KeywordTok{trigger} \KeywordTok{as}\NormalTok{ $$}
\KeywordTok{declare}
\DataTypeTok{year} \DataTypeTok{integer} \OperatorTok{:=} \DecValTok{2019}\NormalTok{;}
\ControlFlowTok{begin}
\ControlFlowTok{if} \KeywordTok{new}\NormalTok{.views }\OperatorTok{>} \DecValTok{750} \ControlFlowTok{then}
\KeywordTok{insert} \KeywordTok{into}\NormalTok{ grammy }\KeywordTok{values}\NormalTok{(}\DataTypeTok{year}\NormalTok{, }\KeywordTok{new}\NormalTok{.songid);}
\ControlFlowTok{end} \ControlFlowTok{if}\NormalTok{;}
\KeywordTok{return} \KeywordTok{new}\NormalTok{;}
\ControlFlowTok{end}\NormalTok{;}
\NormalTok{$$ language plpgsql;}

\KeywordTok{create} \KeywordTok{trigger}\NormalTok{ grammy\_give }\KeywordTok{before} \KeywordTok{insert} \KeywordTok{on}\NormalTok{ song }\ControlFlowTok{for} \KeywordTok{each} \KeywordTok{row} \KeywordTok{execute} \KeywordTok{procedure}\NormalTok{ check\_grammy();}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{6}
\tightlist
\item
  Create a view ``Golden Winners'' which contains the name of the
  song,album and artists which won the Grammy on the year they released.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{create} \KeywordTok{view}\NormalTok{ golden\_winners }\KeywordTok{as} 
   \KeywordTok{select} \DataTypeTok{year}\NormalTok{, songname, albumname, artistname }
      \KeywordTok{from}\NormalTok{ grammy g, album b, artist a, song s }
      \KeywordTok{where} \DataTypeTok{date}\NormalTok{(}\FunctionTok{concat}\NormalTok{(}\DataTypeTok{year}\NormalTok{, }\StringTok{\textquotesingle{}{-}01{-}01\textquotesingle{}}\NormalTok{)) }\OperatorTok{<}\NormalTok{ b.releasedate }
         \KeywordTok{and} \DataTypeTok{date}\NormalTok{(}\FunctionTok{concat}\NormalTok{(}\DataTypeTok{year}\NormalTok{, }\StringTok{\textquotesingle{}{-}12{-}31\textquotesingle{}}\NormalTok{)) }\OperatorTok{>}\NormalTok{ b.releasedate }
         \KeywordTok{and}\NormalTok{ s.songid}\OperatorTok{=}\NormalTok{g.songid }\KeywordTok{and}\NormalTok{ b.albumid}\OperatorTok{=}\NormalTok{s.albumid }
         \KeywordTok{and}\NormalTok{ a.artistid}\OperatorTok{=}\NormalTok{b.artistid;}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{7}
\tightlist
\item
  Decrease the sales by 10\% for all albums released before 2009.
  Perform the operation using cursor.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{create} \KeywordTok{or} \KeywordTok{replace} \KeywordTok{function}\NormalTok{ dec\_sales()}
\NormalTok{returns }\DataTypeTok{integer} \KeywordTok{as}\NormalTok{ $$}
\KeywordTok{declare}
\NormalTok{cur }\KeywordTok{cursor} \ControlFlowTok{for} \KeywordTok{select} \OperatorTok{*} \KeywordTok{from}\NormalTok{ album;}
\NormalTok{rec }\DataTypeTok{record}\NormalTok{;}
\ControlFlowTok{begin}
\KeywordTok{open}\NormalTok{ cur;}
\ControlFlowTok{loop}
\NormalTok{fetch cur }\KeywordTok{into}\NormalTok{ rec;}
\NormalTok{exit }\ControlFlowTok{when} \KeywordTok{not}\NormalTok{ found;}
\ControlFlowTok{if}\NormalTok{ rec.releasedate }\OperatorTok{<} \StringTok{\textquotesingle{}2009{-}01{-}01\textquotesingle{}} \ControlFlowTok{then}
\KeywordTok{update}\NormalTok{ album }\KeywordTok{set}\NormalTok{ sales }\OperatorTok{=} \FloatTok{0.9} \OperatorTok{*}\NormalTok{ sales }\KeywordTok{where} \KeywordTok{current} \KeywordTok{of}\NormalTok{ cur;}
\ControlFlowTok{end} \ControlFlowTok{if}\NormalTok{;}
\ControlFlowTok{end} \ControlFlowTok{loop}\NormalTok{;}
\KeywordTok{return} \KeywordTok{null}\NormalTok{;}
\ControlFlowTok{end}\NormalTok{;}
\NormalTok{$$}
\NormalTok{language plpgsql;}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{8}
\tightlist
\item
  You are given a table, BST, containing two columns: N and P, where N
  represents the value of a node in a Binary Tree, and P is the parent
  of N. Write a query to find the node type of Binary Tree ordered by
  the value of the node. Output one of the following for each node:

  \begin{itemize}
  \tightlist
  \item
    Root: If node is the root node.
  \item
    Leaf: If node is leaf node.
  \item
    Inner: If node is neither root nor leaf node
  \end{itemize}
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{create} \KeywordTok{table}\NormalTok{ bst(}
\NormalTok{n }\DataTypeTok{integer}\NormalTok{,}
\NormalTok{p }\DataTypeTok{integer}\NormalTok{);}

\KeywordTok{INSERT} \KeywordTok{INTO}\NormalTok{ bst }\KeywordTok{VALUES}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{);}
\KeywordTok{INSERT} \KeywordTok{INTO}\NormalTok{ bst }\KeywordTok{VALUES}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{);}
\KeywordTok{INSERT} \KeywordTok{INTO}\NormalTok{ bst }\KeywordTok{VALUES}\NormalTok{(}\DecValTok{6}\NormalTok{, }\DecValTok{8}\NormalTok{);}
\KeywordTok{INSERT} \KeywordTok{INTO}\NormalTok{ bst }\KeywordTok{VALUES}\NormalTok{(}\DecValTok{9}\NormalTok{, }\DecValTok{8}\NormalTok{);}
\KeywordTok{INSERT} \KeywordTok{INTO}\NormalTok{ bst }\KeywordTok{VALUES}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{5}\NormalTok{);}
\KeywordTok{INSERT} \KeywordTok{INTO}\NormalTok{ bst }\KeywordTok{VALUES}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{5}\NormalTok{);}
\KeywordTok{INSERT} \KeywordTok{INTO}\NormalTok{ bst(n) }\KeywordTok{VALUES}\NormalTok{(}\DecValTok{5}\NormalTok{);}

\KeywordTok{select}\NormalTok{ n, }\ControlFlowTok{case}
\ControlFlowTok{when}\NormalTok{ p }\KeywordTok{is} \KeywordTok{null} \ControlFlowTok{then} \StringTok{\textquotesingle{}Root\textquotesingle{}}
\ControlFlowTok{when} \KeywordTok{exists}\NormalTok{ (}\KeywordTok{select} \OperatorTok{*} \KeywordTok{from}\NormalTok{ bst b2 }\KeywordTok{where}\NormalTok{ b2.p}\OperatorTok{=}\NormalTok{b1.n) }\ControlFlowTok{then} \StringTok{\textquotesingle{}Inner\textquotesingle{}}
\ControlFlowTok{else} \StringTok{\textquotesingle{}Leaf\textquotesingle{}}
\ControlFlowTok{end}
\KeywordTok{from}\NormalTok{ bst b1 }\KeywordTok{order} \KeywordTok{by}\NormalTok{ n;}
\end{Highlighting}
\end{Shaded}

\end{document}
